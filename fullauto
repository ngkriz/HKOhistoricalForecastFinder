##functions


#check url
def checkurl():
    print ('url:',url)
    print('search:',search[0])
    print('urlA:',urlA)
    print('urlB:',urlB)
    print('urlC:',urlC)
    print('urlD:',urlD)
    
    
#select the url from the hkgov press release
def ninedayselector():
    global urlA
    global urlB
    global urlC
    
    messtext=data.text
    intolist = messtext.split("/gia")   

           
    search = [KEYWORD for KEYWORD in intolist if ('9-DAY WEATHER FORECAST' in KEYWORD)]

    urlA=search[0].split('>')
    urlB=urlA[0]
    urlC = 'https://www.info.gov.hk/gia'+urlB[:-1]
    urlD.append(urlC)
    print(urlC)
    

#output url is urlC, urlD is the list





#execute to get data from gov press

urlA=[]
urlB=[]
urlC=[]
urlD=[]

import requests



year = str(input("Which year?"))
month = str(input("Which month (in MM) ?"))
day = int(input("How many days in that month?"))

checkingmonth = year+month

D=(str(day).zfill(2))






for d in range (0,day):
    D=(str(d+1).zfill(2))
    url = 'https://www.info.gov.hk/gia/wr/' + checkingmonth +'/'+D+'.htm'
    data = requests.get(url)
    ninedayselector()

import pandas as pd
urldf=pd.DataFrame(urlD)
urldf






#####joining 2 parts together to become full auto

datetemp={'Forecast Issue time':{}}


def tempfinder():
    messtext=data.text


    forecastat = messtext.split('DISPATCHED BY HONG KONG OBSERVATORY ')[1].lstrip().split('<br>')[0]

    datetemp[forecastat]={}


    
    for j in range (0,9):
        if j==0:
            pass
        else:
            datefinder = messtext.split('DATE/MONTH')[j].lstrip().split('(')[0]

            minmaxtemp = messtext.split('TEMP RANGE:')[j].lstrip().split('C')[0]
        
            datetemp[forecastat][datefinder]=minmaxtemp








for i in range (0,len(urlD)):
    url = urlD[i]
    data = requests.get(url)
    tempfinder()

    
import pandas as pd
dt=pd.DataFrame(datetemp)
dt


dt.to_csv (r'\Users\CN\Desktop\export_dataframe.csv', index = true, header=True)
